# RFC-002: 数据钩子更新机制

状态：Provisional | 所属层：方案层 | 变更范围：数据更新流程与文件结构

## 目标
- 以本地 JSON 作为单一事实源；前端只读，钩子负责更新。

## 范围
- 钩子执行方式：定时任务（cron/CI）与手动触发。
- 平台适配：每个平台一个独立钩子（如 github-hook），互不影响、可并行。

## 输出契约（草案）
- 输出文件：`data/workitems.json`
- 结构：统一 `WorkItem[]`（含 `kind` 与 `attributes` 扩展），保证向后兼容。
- 合并策略：多钩子写入同一文件时的去重/合并（按 `id+kind`）。

## 降级与容错
- 写入失败：保留旧文件并记录错误；下次重试。
- 部分平台失败：其他平台数据不受影响。
- 文件校验：写入前后进行 schema 校验，失败则回滚。

## 安全与凭证
- 凭证仅在钩子侧使用（环境变量/CI 密钥），不进入前端与 JSON。

## 待确认
- Schema 草案（与 RFC-001 字段对齐）。
- 合并/去重的主键与时间字段。
- 日志与可观测性（最小）。

---
关联：`docs/design.md`（方向层数据策略），`RFC-001-code-providers.md`（GitHub 字段映射）。
